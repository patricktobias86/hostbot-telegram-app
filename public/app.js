const showMessage=(e,s)=>{const t=document.getElementById(e);t&&(t.textContent=s)},{username:username}=window.Telegram.WebApp.initDataUnsafe.user,userName=username?username.toLowerCase():"";async function callNetlifyFunction(e,s={}){try{const t=await fetch(`/.netlify/functions/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error(`Server responded with status: ${t.status}`);return await t.json()}catch(e){return console.error("API Error:",e),showMessage("errorMsg","Failed to process request."),null}}async function selfAssignDiscordId(e){return await callNetlifyFunction("selfAssign",{userName:e})}const disableButton=(e,s=1e4)=>{e.disabled=!0;const t=e.textContent;e.textContent="Please wait...",setTimeout((()=>{e.disabled=!1,e.textContent=t}),s)};document.getElementById("apiRequestBtn")?.addEventListener("click",(async()=>{const e=document.getElementById("apiRequestBtn");if(!userName)return void showMessage("errorMsg","Telegram username not found");disableButton(e);const s=await selfAssignDiscordId(userName);s?.message?showMessage("responseMsg",s.message):showMessage("errorMsg","Failed to self-assign Discord ID.")}));