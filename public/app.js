const showMessage=(e,s)=>{const n=document.getElementById(e);n&&(n.textContent=s)},{username:username}=window.Telegram.WebApp.initDataUnsafe.user,userName=username?username.toLowerCase():"";async function callNetlifyFunction(e,s={}){try{const n=await fetch(`/.netlify/functions/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok)throw new Error(`Server responded with status: ${n.status}`);return await n.json()}catch(e){return console.error("API Error:",e),showMessage("errorMsg","Failed to process request."),null}}async function selfAssignDiscordId(e){return await callNetlifyFunction("selfAssign",{userName:e})}document.getElementById("apiRequestBtn")?.addEventListener("click",(async()=>{if(!userName)return void showMessage("errorMsg","Telegram username not found");const e=await selfAssignDiscordId(userName);e?.message?showMessage("responseMsg",e.message):showMessage("errorMsg","Failed to self-assign Discord ID.")}));